<include file="./APP/Modules/Index/Tpl/default/Public/header.html" />
<div class="listBoxGen">
        <div class="listBoxTitleGen"><div class="showTitle">修改密码</div></div>
            <div class="listBoxContentGen">
                
	            
<script type="text/javascript"> 
$(document).ready(function() {

    $("#ctl00_ContentPlaceHolder1_txtUserPass1").blur(function() { checkUserPass1(); });
    $("#ctl00_ContentPlaceHolder1_txtNewUserPass1").blur(function() { checkNewUserPass1(); });
    $("#ctl00_ContentPlaceHolder1_txtConfirmUserPass1").blur(function() { checkConfirmUserPass1(); });
    $("#ctl00_ContentPlaceHolder1_SavePass1").click(function() {
        return checkPass1();
    });
    
    $("#ctl00_ContentPlaceHolder1_txtUserPass2").blur(function() { checkUserPass2(); });
    $("#ctl00_ContentPlaceHolder1_txtNewUserPass2").blur(function() { checkNewUserPass2(); });
    $("#ctl00_ContentPlaceHolder1_txtConfirmUserPass2").blur(function() { checkConfirmUserPass2(); });
    $("#ctl00_ContentPlaceHolder1_SavePass2").click(function() {
        return checkPass2();
    });
});

function checkPass1() {
    if (!checkUserPass1()) { alert("您输入的登陆密码不正确");$("#ctl00_ContentPlaceHolder1_txtUserPass1").focus(); return false; }
    if (!checkNewUserPass1()) { alert("请正确输入新登陆密码");$("#ctl00_ContentPlaceHolder1_txtNewUserPass1").focus(); return false; }
    if (!checkConfirmUserPass1()) { alert("请正确输入确认新登陆密码");$("#ctl00_ContentPlaceHolder1_txtConfirmUserPass1").focus(); return false; }
    $("#ctl00_ContentPlaceHolder1_SavePass1").hide();
    $("#showText1").html('<img src=/Images/loading.gif> 正在提交中…')
    return true;
}

function checkPass2() {
    if (!checkUserPass2()) { alert("请正确输入原二级密码");$("#ctl00_ContentPlaceHolder1_txtUserPass2").focus(); return false; }
    if (!checkNewUserPass2()) { alert("请正确输入新二级密码");$("#ctl00_ContentPlaceHolder1_txtNewUserPass2").focus(); return false; }
    if (!checkConfirmUserPass2()) { alert("请正确输入新二级密码");$("#ctl00_ContentPlaceHolder1_txtConfirmUserPass2").focus(); return false; }
    $("#ctl00_ContentPlaceHolder1_SavePass2").hide();
    $("#showText2").html('<img src=/Images/loading.gif> 正在提交中…')
    return true;
}

function checkUserPass1() {
    if ($("#ctl00_ContentPlaceHolder1_txtUserPass1").val() == "") {
        hintMessage("lblUserPass1", "error", "请输入登录密码");
        return false;
    }
    hintMessage("lblUserPass1", "right", "");
    return true;
}
function checkNewUserPass1() {
    if ($("#ctl00_ContentPlaceHolder1_txtNewUserPass1").val() == "") {
        hintMessage("lblNewUserPass1", "error", "请输入二级密码");
        return false;
    }
    if ($("#ctl00_ContentPlaceHolder1_txtNewUserPass1").val().length < 3 || $("#ctl00_ContentPlaceHolder1_txtNewUserPass1").val().length > 20) {
        hintMessage("lblNewUserPass1", "error", "密码长度为3~20个字符");
        return false;
    }
    if (!chkPwd($("#ctl00_ContentPlaceHolder1_txtNewUserPass1").val())) {
        hintMessage("lblNewUserPass1", "error", "密码必须包含数字加字母，请重新输入");
        return false;
    }
    if (chkPwdIsDefault($("#ctl00_ContentPlaceHolder1_txtNewUserPass1").val())) {
        hintMessage("lblNewUserPass1", "error", "不能使用此默认密码，请重新输入");
        return false;
    }
    hintMessage("lblNewUserPass1", "right", "");
    return true;
}
function checkConfirmUserPass1() {
    if ($("#ctl00_ContentPlaceHolder1_txtConfirmUserPass1").val() == "") {
        hintMessage("lblConfirmUserPass1", "error", "请再次确认新一级密码");
        return false;
    }
    if ($("#ctl00_ContentPlaceHolder1_txtConfirmUserPass1").val() != $("#ctl00_ContentPlaceHolder1_txtNewUserPass1").val()) {
        hintMessage("lblConfirmUserPass1", "error", "两次输入的密码不一致，请重新输入");
        return false;
    }
    hintMessage("lblConfirmUserPass1", "right", "");
    return true;
}

function checkUserPass2() {
    if ($("#ctl00_ContentPlaceHolder1_txtUserPass2").val() == "") {
        hintMessage("lblUserPass2", "error", "请输入原二级密码");
        return false;
    }
    hintMessage("lblUserPass2", "right", "");
    return true;
}
function checkNewUserPass2() {
    if ($("#ctl00_ContentPlaceHolder1_txtNewUserPass2").val() == "") {
        hintMessage("lblNewUserPass2", "error", "请输入原二级密码");
        return false;
    }
    if ($("#ctl00_ContentPlaceHolder1_txtNewUserPass2").val().length < 3 || $("#ctl00_ContentPlaceHolder1_txtNewUserPass2").val().length > 20) {
        hintMessage("lblNewUserPass2", "error", "密码长度为3~20个字符");
        return false;
    }
    if (!chkPwd($("#ctl00_ContentPlaceHolder1_txtNewUserPass2").val())) {
        hintMessage("lblNewUserPass2", "error", "密码必须包含数字加字母，请重新输入");
        return false;
    }
    if (chkPwdIsDefault($("#ctl00_ContentPlaceHolder1_txtNewUserPass2").val())) {
        hintMessage("lblNewUserPass2", "error", "不能使用此默认密码，请重新输入");
        return false;
    }
    hintMessage("lblNewUserPass2", "right", "");
    return true;
}
function checkConfirmUserPass2() {
    if ($("#ctl00_ContentPlaceHolder1_txtConfirmUserPass2").val() == "") {
        hintMessage("lblConfirmUserPass2", "error", "请再次确认新二级密码");
        return false;
    }
    if ($("#ctl00_ContentPlaceHolder1_txtConfirmUserPass2").val() != $("#ctl00_ContentPlaceHolder1_txtNewUserPass2").val()) {
        hintMessage("lblConfirmUserPass2", "error", "两次输入的密码不一致，请重新输入");
        return false;
    }
    hintMessage("lblConfirmUserPass2", "right", "");
    return true;
}

//密码必须是在3-20位字母加组字
function chkPwd(passwd) {
    if (/^.*?[\d]+.*$/.test(passwd) && /^.*?[A-Za-z].*$/.test(passwd) && /^.{3,20}$/.test(passwd)) {
        return true;
    }
    else {
        return false;
    }
}
//检测密码是否默认
function chkPwdIsDefault(passwd) {
    if (passwd.toLowerCase() == "p123456" || passwd.toLowerCase() == "p654321") {
        return true;
    }
    else {
        return false;
    }
}

document.onkeydown = mykeydown;
function mykeydown() {
    if (event.keyCode == 116) {
        window.event.keyCode = 0;
        return false;
    }
}
</script>
<div style="padding-left:30px; padding-top:10px; padding-bottom:10px; line-height:150%; color:Red">
说明：修改密码请注意字母区分大小写！密码必须包含字母与数字的组合，注意不要使用abc123之类太过简单的密码，以防帐号被盗！
</div>
<fieldset class="fieldset">
<legend><span class="fieldset_title">修改新增会员密码</span>！</legend>
<br />
<form action="{:U('editPasswordHandle')}" method="post">
    <table border="0" align="center" cellpadding="0" cellspacing="0" class="CommonTb">
    <tr>
    <td align="right" style="width:40%;">会员编号：</td>
    <td><span id="ctl00_ContentPlaceHolder1_UserName" style="color:Red;">{$mem.username}</span></td>
    </tr>
    <tr>
    <td align="right">新的登录密码：</td>
    <td class="lmcontent"><input name="pass1" type="password" maxlength="20" class="text" style="width:220px;" /><span id="lblUserPass1" class="infoTips"></span></td>
    </tr>
    <tr>
    <td align="right">新的二级密码：</td>
    <td class="lmcontent"><input name="pass2" type="password" maxlength="20" class="text" style="width:220px;" /><span id="lblNewUserPass1" class="infoTips"></span></td>
    </tr>
    <input type="hidden" value="{$Think.get.id}" name="id" />
    </table>
<div class="CommonTbBtnBox"><input type="submit" value="提交" id="ctl00_ContentPlaceHolder1_SavePass1" class="buttom" /><span id="showText1"></span></div>
</form>
</fieldset>
<br />

            </div>
            <br /><br />
        </div>
	</div>
</div>

<!-- Transparent layer --> 
<div id="divBox" style="filter:alpha(opacity=40);-moz-opacity:0.3;opacity:0.3;background-color:#000;width:100%;height:100%;z-index:1000;position: absolute;left:0;top:0;display:none;overflow: hidden;">
</div>
<!-- message layer --> 
<div id="divMsg" style="border:solid 5px #339999;background:#fff;padding:10px;width:780px;z-index:1001; position: absolute; display:none;top:50%; left:50%;margin:-200px 0 0 -400px;"> 
    <div style="padding:3px 15px 3px 15px;text-align:left;vertical-align:middle;" > 
        <div class="IndexShowMsg"> 
            <div id="divShowMsg"></div>
            
        </div> 
        <br/>
        <div id="showbtnCancel" style="text-align:right;"> 
            <input id="btnCancel" type="button" class="buttom" value=" 关闭 " onclick="ShowNo()" /> 
        </div> 
    </div> 
</div> 
</body>
</html>